<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>COUSIN</title>
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="components.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-user-drag: none;
      -khtml-user-drag: none;
      -moz-user-drag: none;
      -o-user-drag: none;
      user-drag: none;
    }

    body {
      font-family: 'Space Mono', monospace;
      background-color: #ffffff;
      color: #000000;
      font-size: 18px;
      line-height: 100%;
      font-weight: 400;
      letter-spacing: -0.02em;
      text-transform: uppercase;
    }

    .logo {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: auto;
      padding: 1em;
      z-index: 500;
      pointer-events: none;
      mix-blend-mode: multiply;
      opacity: 1;
      transition: opacity 0.3s ease;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-user-drag: none;
      -khtml-user-drag: none;
      -moz-user-drag: none;
      -o-user-drag: none;
      user-drag: none;
    }

    /* Ariel logo specific positioning */
    .logo[src*="Ariel"] {
      left: auto;
      right: 0;
      width: 60%;
    }

    /* Mobile responsive Ariel logo */
    @media (max-width: 768px) {
      .logo[src*="Ariel"] {
        width: 100%;
        left: 0;
        right: 0;
      }
    }

    .logo.hidden {
      opacity: 0;
    }

    .nav {
      position: fixed;
      bottom: 1em;
      left: 1em;
      z-index: 2000;
    }

    .nav-list {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .nav-item {
      margin-bottom: 0;
    }

    .nav-toggle {
      cursor: pointer;
      margin-bottom: 0;
    }

    .nav-toggle:hover {
      color: rgba(0, 0, 0, 0.5);
    }

    .nav-sublist {
      list-style: none;
      margin: 0;
      padding: 0;
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      transition: max-height 0.3s ease, opacity 0.3s ease, margin-bottom 0.3s ease;
    }

    .nav-sublist.open {
      max-height: 800px;
      opacity: 1;
      margin-bottom: 0;
    }

    /* Add spacing only to Directors sublist */
    #directors-content.open {
      margin-bottom: 1em;
    }

    /* Add spacing to About sublist as well */
    #about-content.open {
      margin-bottom: 1em;
    }

    .nav-sublist li {
      padding-left: 1em;
      margin-bottom: 0;
    }

    .nav-sublist .nav-sublist li {
      padding-left: 2em;
    }

    /* Project items */
    .project-item {
      cursor: pointer;
      margin-bottom: 0;
    }

    .project-item:hover {
      color: rgba(0, 0, 0, 0.5);
    }

    /* Loading state for project items */
    .project-item.loading {
      pointer-events: none; /* Disable all mouse interactions during loading */
    }

    /* Loading cursor for the entire body when projects are loading */
    body.loading {
      cursor: wait !important;
    }

    /* Ensure all interactive elements show loading cursor during loading */
    body.loading * {
      cursor: wait !important;
    }

    /* Director Toggle */
    .director-toggle {
      position: fixed;
      bottom: 1em;
      right: 1em;
      z-index: 2000;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.3s ease, transform 0.3s ease;
      pointer-events: none;
      background: rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(0, 0, 0, 0.2);
      border-radius: 20px;
      padding: 0.5em 1em;
      cursor: pointer;
      font-family: 'Space Mono', monospace;
      font-size: 14px;
      color: #000;
      text-transform: uppercase;
      letter-spacing: -0.02em;
      user-select: none;
    }

    .director-toggle.visible {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    .director-toggle:hover {
      background: rgba(0, 0, 0, 0.2);
      border-color: rgba(0, 0, 0, 0.4);
    }

    .director-toggle.active {
      background: #000;
      color: #fff;
    }

    /* Hover trigger area in bottom right corner */
    .toggle-trigger-area {
      position: fixed;
      bottom: 0;
      right: 0;
      width: 100px;
      height: 100px;
      z-index: 1999;
      pointer-events: auto;
    }


    /* Video Player */
    .director-portfolio-lightbox {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: transparent;
      flex-direction: column;
      z-index: 1000;
    }

    .director-portfolio-lightbox[data-active="1"] {
      display: flex;
    }

    .director-portfolio-lightbox-media {
      position: relative;
      display: flex;
      align-items: flex-start;
      justify-content: flex-start;
      padding: 1em;
    }

    .director-portfolio-lightbox-media-video-container {
      position: relative;
      display: inline-block;
    }

    .director-portfolio-lightbox-media-video {
      max-width: 75vw;
      max-height: calc(100vh - 2em);
      width: 75vw;
      height: auto;
      object-fit: contain;
      display: block;
      vertical-align: top;
      transform: translateZ(0);
      backface-visibility: hidden;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-user-drag: none;
      -khtml-user-drag: none;
      -moz-user-drag: none;
      -o-user-drag: none;
      user-drag: none;
    }

    /* Mobile responsive video sizing */
    @media (max-width: 768px) {
      .director-portfolio-lightbox-media-video {
        max-width: calc(100vw - 2em);
        width: calc(100vw - 2em);
        max-height: calc(100vh - 2em);
      }
    }

    .director-portfolio-lightbox-media-playbar {
      width: 100%;
      height: 4px;
      background: rgba(0, 0, 0, 0.3);
      cursor: pointer;
      margin-top: 0;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .director-portfolio-lightbox-media-playbar.show {
      opacity: 1;
    }

    .director-portfolio-lightbox-media-playbar-meter {
      width: 100%;
      height: 100%;
    }

    .director-portfolio-lightbox-media-playbar-meter-progress {
      width: 0%;
      height: 100%;
      background: #000;
    }

    .director-portfolio-lightbox-video-controls {
      margin-top: 1em;
      display: flex;
      align-items: center;
      justify-content: space-between;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .director-portfolio-lightbox-video-controls.show {
      opacity: 1;
    }

    .director-portfolio-lightbox-video-controls-left {
      display: flex;
      align-items: center;
      gap: 1em;
    }

    .director-portfolio-lightbox-video-controls-right {
      color: #000;
      font-family: 'Space Mono', monospace;
      font-size: 18px;
      line-height: 100%;
      font-weight: 400;
      letter-spacing: -0.02em;
      text-transform: uppercase;
      cursor: pointer;
    }

    .director-portfolio-lightbox-controls-play,
    .director-portfolio-lightbox-controls-pause {
      cursor: pointer;
      color: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      line-height: 18px;
      transition: opacity 0.2s ease;
    }

    .director-portfolio-lightbox-controls-play:hover,
    .director-portfolio-lightbox-controls-pause:hover {
      opacity: 0.5;
    }

    .director-portfolio-lightbox-controls-play[data-active="0"],
    .director-portfolio-lightbox-controls-pause[data-active="0"] {
      display: none;
    }

    .director-portfolio-lightbox-controls-play svg,
    .director-portfolio-lightbox-controls-pause svg {
      fill: #000;
      stroke: #000;
    }

    .director-portfolio-lightbox-controls-time {
      color: #000;
      font-family: 'Space Mono', monospace;
      font-size: 18px;
      line-height: 100%;
      font-weight: 400;
      letter-spacing: -0.02em;
      text-transform: uppercase;
    }

    /* Video hover overlay */
    .video-hover-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: transparent;
      display: none;
      flex-direction: column;
      z-index: 1500;
      pointer-events: none;
    }

    .video-hover-overlay[data-active="1"] {
      display: flex;
    }

    .video-hover-overlay-media {
      position: relative;
      display: flex;
      align-items: flex-start;
      justify-content: flex-start;
      padding: 1em;
    }

    .video-hover-overlay-media-video-container {
      position: relative;
      display: inline-block;
    }

    .video-hover-overlay-media-video {
      max-width: 75vw;
      max-height: calc(100vh - 2em);
      width: 75vw;
      height: auto;
      object-fit: contain;
      display: block;
      vertical-align: top;
      transform: translateZ(0);
      backface-visibility: hidden;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-user-drag: none;
      -khtml-user-drag: none;
      -moz-user-drag: none;
      -o-user-drag: none;
      user-drag: none;
    }

    /* Mobile responsive hover overlay video sizing */
    @media (max-width: 768px) {
      .video-hover-overlay-media-video {
        max-width: calc(100vw - 2em);
        width: calc(100vw - 2em);
        max-height: calc(100vh - 2em);
      }
    }

    /* Contact image overlay */
    .contact-image-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: transparent;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      pointer-events: none;
    }

    .contact-image-overlay.show {
      display: flex;
    }

    .contact-image-overlay img {
      max-width: 200px;
      max-height: 200px;
      width: auto;
      height: auto;
      opacity: 1;
      transition: opacity 0.3s ease;
    }

    /* Mobile responsive contact image */
    @media (max-width: 768px) {
      .contact-image-overlay img {
        max-width: 150px;
        max-height: 150px;
      }
    }

    /* Prevent dragging for all images and videos */
    img, video {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-user-drag: none;
      -khtml-user-drag: none;
      -moz-user-drag: none;
      -o-user-drag: none;
      user-drag: none;
    }
  </style>
</head>
<body>
  <img src="cousin_logo_HiRes_2.png" alt="COUSIN" class="logo">

  <nav class="nav">
    <ul class="nav-list">
      <li class="nav-item">
        <div id="about-toggle" class="nav-toggle">About</div>
        <ul id="about-content" class="nav-sublist">
          <li>That person you ran with</li>
          <li>The one you trusted</li>
          <li>The one you built stuff with</li>
          <li>Wrecked stuff with</li>
          <li>The one who lit the fuse and said run</li>
        </ul>
      </li>
      
      <li class="nav-item">
        <div id="directors-toggle" class="nav-toggle">Directors</div>
        <ul id="directors-content" class="nav-sublist">
          <li>
            <div id="ariel-toggle" class="nav-toggle">Ariel martin</div>
            <ul id="ariel-projects" class="nav-sublist">
              <!-- Projects will be loaded dynamically from CSV -->
            </ul>
          </li>
          <li id="max-director" style="display: none;">
            <div id="max-toggle" class="nav-toggle">Max Chan</div>
            <ul id="max-projects" class="nav-sublist">
              <li class="project-item" data-video="dummy-video-1.mp4">Nike 'Just Do It'</li>
              <li class="project-item" data-video="dummy-video-2.mp4">Apple 'Think Different'</li>
              <li class="project-item" data-video="dummy-video-3.mp4">McDonald's 'I'm Lovin It'</li>
            </ul>
          </li>
        </ul>
      </li>
      
      <li class="nav-item">
        <div id="contact-toggle" class="nav-toggle">Contact</div>
        <ul id="contact-content" class="nav-sublist">
          <li>hello@cousin.com.au</li>
          <li>+61 2 1234 5678</li>
          <li>Sydney, Australia</li>
          <li>Follow us on Instagram</li>
        </ul>
      </li>
    </ul>
  </nav>

  <!-- Toggle trigger area and switch -->
  <div class="toggle-trigger-area" id="toggle-trigger-area"></div>
  <div class="director-toggle" id="director-toggle">
    <span id="toggle-text">Single Director</span>
  </div>

  <!-- Contact image overlay -->
  <div class="contact-image-overlay" id="contact-image-overlay">
    <img src="hi.png" alt="Hi">
  </div>

  <!-- Image hover overlay - shows only image -->
  <div class="video-hover-overlay" data-active="0">
    <div class="video-hover-overlay-media">
      <div class="video-hover-overlay-media-video-container">
        <img class="video-hover-overlay-media-video" src="" alt="">
      </div>
    </div>
  </div>

  <div class="director-portfolio-lightbox" data-active="0">
    <div class="director-portfolio-lightbox-media">
      <div class="director-portfolio-lightbox-media-video-container">
        <video playsinline class="director-portfolio-lightbox-media-video" onclick="toggleVideo();">
          <source>
        </video>
        <div class="director-portfolio-lightbox-media-playbar" onmousedown="setProgress(event);" ontouchstart="setProgress(event);">
          <div class="director-portfolio-lightbox-media-playbar-meter">
            <div class="director-portfolio-lightbox-media-playbar-meter-progress"></div>
          </div>
        </div>
        <div class="director-portfolio-lightbox-video-controls">
          <div class="director-portfolio-lightbox-video-controls-left">
            <div class="director-portfolio-lightbox-controls-play" data-active="1" onclick="playVideo();">
              <svg width="18" height="18" viewBox="0 0 18 18"><path d="M15.75 9L2.25 15.75L2.25 2.25L15.75 9Z"/></svg>
            </div>
            <div class="director-portfolio-lightbox-controls-pause" data-active="0" onclick="pauseVideo();">
              <svg width="18" height="18" viewBox="0 0 18 18"><rect x="3" y="3" width="4.5" height="12" fill="currentColor"/><rect x="10.5" y="3" width="4.5" height="12" fill="currentColor"/></svg>
            </div>
            <div class="director-portfolio-lightbox-controls-time">
              <span class="director-portfolio-lightbox-controls-time-current">00:00</span> â€“ <span class="director-portfolio-lightbox-controls-time-total">00:00</span>
            </div>
          </div>
          <div class="director-portfolio-lightbox-video-controls-right" onclick="toggleFullscreen();">
            FULL SCREEN
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Navigation functionality
    document.getElementById('about-toggle').addEventListener('click', function(e) {
      const content = document.getElementById('about-content');
      const directorsContent = document.getElementById('directors-content');
      const contactContent = document.getElementById('contact-content');
      const arielContent = document.getElementById('ariel-projects');
      const maxContent = document.getElementById('max-projects');
      const contactImageOverlay = document.getElementById('contact-image-overlay');
      
      // Close other main sections AND their sub-sections
      directorsContent.classList.remove('open');
      contactContent.classList.remove('open');
      arielContent.classList.remove('open'); // Also close Ariel Martin
      maxContent.classList.remove('open'); // Also close Max Chan
      
      // Hide contact image when opening other sections
      contactImageOverlay.classList.remove('show');
      
      // Toggle current section
      content.classList.toggle('open');
      
      // Always reset everything when clicking About/Contact/Directors
      closeVideoAndReset();
    });

    // Global logo management function
    function updateLogo() {
      const logo = document.querySelector('.logo');
      const arielContent = document.getElementById('ariel-projects');
      const contactContent = document.getElementById('contact-content');
      const isMobile = window.innerWidth <= 768;
      
      if (contactContent.classList.contains('open')) {
        // Hide Cousin logo when contact section is open (hi.png is showing)
        logo.classList.add('hidden');
      } else if (arielContent.classList.contains('open')) {
        // Only show Ariel PNG when Ariel Martin section is specifically open
        logo.src = 'Ariel_Martin/Ariel.png';
        logo.classList.remove('hidden');
      } else {
        // Show Cousin logo in ALL other scenarios
        if (isMobile) {
          logo.src = 'logo_varients/CousinMed.png';
        } else {
          logo.src = 'cousin_logo_HiRes_2.png';
        }
        logo.classList.remove('hidden');
      }
    }

    // Global function to close video and reset everything
    function closeVideoAndReset() {
      closeVideoPlayer();
      hideVideoHoverOverlay();
      updateLogo(); // Reset logo to Cousin
    }

    document.getElementById('directors-toggle').addEventListener('click', function(e) {
      const content = document.getElementById('directors-content');
      const aboutContent = document.getElementById('about-content');
      const contactContent = document.getElementById('contact-content');
      const arielContent = document.getElementById('ariel-projects');
      const maxContent = document.getElementById('max-projects');
      const contactImageOverlay = document.getElementById('contact-image-overlay');
      
      // Close other main sections
      aboutContent.classList.remove('open');
      contactContent.classList.remove('open');
      
      // Hide contact image when opening other sections
      contactImageOverlay.classList.remove('show');
      
      // Toggle current section
      content.classList.toggle('open');
      
      // If directors section is being closed, also close sub-sections
      if (!content.classList.contains('open')) {
        arielContent.classList.remove('open');
        maxContent.classList.remove('open');
      }
      
      // Always reset everything when clicking About/Contact/Directors
      closeVideoAndReset();
    });

    document.getElementById('ariel-toggle').addEventListener('click', function(e) {
      const content = document.getElementById('ariel-projects');
      const maxContent = document.getElementById('max-projects');
      
      // Close Max Chan if it's open
      maxContent.classList.remove('open');
      
      // Toggle current section
      content.classList.toggle('open');
      
      // Update logo based on ariel section state
      updateLogo();
      
      if (content.classList.contains('open')) {
        // Disable hover effects for 1.25 seconds after expanding
        disableHoverEffects();
        setTimeout(() => {
          enableHoverEffects();
        }, 1250);
      } else {
        // If ariel section is being closed, reset everything
        closeVideoAndReset();
      }
    });

    document.getElementById('max-toggle').addEventListener('click', function(e) {
      const content = document.getElementById('max-projects');
      const arielContent = document.getElementById('ariel-projects');
      
      // Close Ariel Martin if it's open
      arielContent.classList.remove('open');
      
      // Toggle current section
      content.classList.toggle('open');
      
      if (!content.classList.contains('open')) {
        // If max section is being closed, reset everything
        closeVideoAndReset();
      }
    });

    document.getElementById('contact-toggle').addEventListener('click', function(e) {
      const content = document.getElementById('contact-content');
      const aboutContent = document.getElementById('about-content');
      const directorsContent = document.getElementById('directors-content');
      const arielContent = document.getElementById('ariel-projects');
      const contactImageOverlay = document.getElementById('contact-image-overlay');
      
      // Close other main sections AND their sub-sections
      aboutContent.classList.remove('open');
      directorsContent.classList.remove('open');
      arielContent.classList.remove('open'); // Also close Ariel Martin
      
      // Toggle current section
      content.classList.toggle('open');
      
      // Show/hide contact image based on contact section state
      if (content.classList.contains('open')) {
        contactImageOverlay.classList.add('show');
      } else {
        contactImageOverlay.classList.remove('show');
      }
      
      // Update logo visibility (hide Cousin when contact is open)
      updateLogo();
      
      // Always reset everything when clicking About/Contact/Directors
      closeVideoAndReset();
    });

    // Load CSV data and create project elements
    Papa.parse('ArielMartin.csv', {
      download: true,
      header: true,
      complete: function(results) {
        const container = document.getElementById('ariel-projects');
        
        // Filter out empty rows
        const validData = results.data.filter(item => item.Client && item.Title);

        validData.forEach(function(row, index) {
          const projectElement = document.createElement('li');
          projectElement.className = 'project-item';
          projectElement.textContent = `${row.Client} '${row.Title}'`;
          projectElement.dataset.thumbnail = row.Thumbnail;
          projectElement.dataset.video = row.Video;
          projectElement.dataset.index = index;
          
          // Add hover events
          projectElement.addEventListener('mouseenter', function(e) {
            e.stopPropagation();
            
            // Check if hover effects are enabled
            if (!hoverEffectsEnabled) {
              return;
            }
            
            const player = document.querySelector('.director-portfolio-lightbox');
            const videoSrc = row.Video;
            
            if (videoSrc) {
              if (player.getAttribute('data-active') === '1') {
                // Video player is open - show temporary hover overlay
                showVideoHoverOverlay(videoSrc);
              } else {
                // Video player is closed - show normal hover overlay
                showVideoHoverOverlay(videoSrc);
              }
            }
          });

          projectElement.addEventListener('mouseleave', function(e) {
            e.stopPropagation();
            
            const player = document.querySelector('.director-portfolio-lightbox');
            if (player.getAttribute('data-active') === '1') {
              // Video player is open - hide hover overlay to return to video
              hideVideoHoverOverlay();
            } else {
              // Video player is closed - hide hover overlay normally
              hideVideoHoverOverlay();
            }
          });
          
          // Add click event
          projectElement.addEventListener('click', function(e) {
            e.stopPropagation();
            
            const videoSrc = row.Video;
            if (videoSrc) {
              openVideoPlayer(videoSrc);
            }
          });
          
          container.appendChild(projectElement);
        });
      }
    });

    // Hover effects control
    let hoverEffectsEnabled = true;
    
    function disableHoverEffects() {
      hoverEffectsEnabled = false;
      console.log('Hover effects disabled');
      
      // Add loading state to project items and body
      const projectItems = document.querySelectorAll('.project-item');
      projectItems.forEach(item => {
        item.classList.add('loading');
      });
      
      // Add loading cursor to entire body
      document.body.classList.add('loading');
    }
    
    function enableHoverEffects() {
      hoverEffectsEnabled = true;
      console.log('Hover effects enabled');
      
      // Remove loading state from project items and body
      const projectItems = document.querySelectorAll('.project-item');
      projectItems.forEach(item => {
        item.classList.remove('loading');
      });
      
      // Remove loading cursor from body
      document.body.classList.remove('loading');
    }

    // Image hover overlay functions
    function showVideoHoverOverlay(videoSrc) {
      const overlay = document.querySelector('.video-hover-overlay');
      const img = overlay.querySelector('.video-hover-overlay-media-video');
      
      // Pause the main video player if it's playing and store its state
      const mainPlayer = document.querySelector('.director-portfolio-lightbox-media-video');
      if (mainPlayer && !mainPlayer.paused) {
        mainPlayer.pause();
        mainPlayer.setAttribute('data-was-playing', 'true');
        console.log('Main video player paused');
      } else {
        mainPlayer.setAttribute('data-was-playing', 'false');
      }
      
      // Hide controls and UI when entering hover mode
      const playbar = document.querySelector('.director-portfolio-lightbox-media-playbar');
      const controls = document.querySelector('.director-portfolio-lightbox-video-controls');
      if (playbar) playbar.classList.remove('show');
      if (controls) controls.classList.remove('show');
      
      // Convert video path to image path
      let imageSrc;
      if (videoSrc.includes('KIA_SNIPPET.mp4')) {
        imageSrc = 'Ariel_Martin/Kia_optimized.png';
      } else if (videoSrc.includes('WAPOLICE-SNIPPET.mp4')) {
        imageSrc = 'Ariel_Martin/WA_police_optimized.png';
      } else if (videoSrc.includes('VODA_SNIPPET.mp4')) {
        imageSrc = 'Ariel_Martin/Vodafone_optimized.png';
      }
      
      img.src = imageSrc;
      overlay.setAttribute('data-active', '1');
      console.log('Hover overlay shown for:', imageSrc);
    }

    function hideVideoHoverOverlay() {
      const overlay = document.querySelector('.video-hover-overlay');
      const img = overlay.querySelector('.video-hover-overlay-media-video');
      const player = document.querySelector('.director-portfolio-lightbox');
      const mainPlayer = document.querySelector('.director-portfolio-lightbox-media-video');
      
      img.src = '';
      overlay.setAttribute('data-active', '0');
      overlay.style.opacity = '1'; // Reset opacity for next hover
      
      // If video player is active, restore the controls and resume if it was playing
      if (player.getAttribute('data-active') === '1') {
        const playbar = document.querySelector('.director-portfolio-lightbox-media-playbar');
        const controls = document.querySelector('.director-portfolio-lightbox-video-controls');
        if (playbar) playbar.classList.add('show');
        if (controls) controls.classList.add('show');
        
        // Resume video if it was playing before hover
        if (mainPlayer.getAttribute('data-was-playing') === 'true') {
          mainPlayer.play();
          console.log('Main video player resumed');
        }
      }
    }

    function openVideoPlayer(videoSrc) {
      // Hide hover overlay first
      hideVideoHoverOverlay();
      
      const player = document.querySelector('.director-portfolio-lightbox');
      const videoSource = player.querySelector('.director-portfolio-lightbox-media-video source');
      const videoElement = player.querySelector('.director-portfolio-lightbox-media-video');
      
      videoSource.src = videoSrc;
      
      // Set poster image based on video
      if (videoSrc.includes('KIA_SNIPPET.mp4')) {
        videoElement.poster = 'Ariel_Martin/Kia_optimized.png';
      } else if (videoSrc.includes('WAPOLICE-SNIPPET.mp4')) {
        videoElement.poster = 'Ariel_Martin/WA_police_optimized.png';
      } else if (videoSrc.includes('VODA_SNIPPET.mp4')) {
        videoElement.poster = 'Ariel_Martin/Vodafone_optimized.png';
      }
      
      videoElement.load();
      
      // Reset video to beginning
      videoElement.currentTime = 0;
      
      // Show the video player
      player.setAttribute('data-active', '1');
      
      // Auto play video
      videoElement.play();
      updateTimeDisplay();
      
      // Reset progress bar
      const progressBar = document.querySelector('.director-portfolio-lightbox-media-playbar-meter-progress');
      if (progressBar) {
        progressBar.style.width = '0%';
      }
      
      // Show controls after a short delay
      setTimeout(() => {
        const playbar = document.querySelector('.director-portfolio-lightbox-media-playbar');
        const controls = document.querySelector('.director-portfolio-lightbox-video-controls');
        playbar.classList.add('show');
        controls.classList.add('show');
      }, 500);
      
      // Update button states - show pause button since video autoplays
      const playBtn = document.querySelector('.director-portfolio-lightbox-controls-play');
      const pauseBtn = document.querySelector('.director-portfolio-lightbox-controls-pause');
      playBtn.setAttribute('data-active', '0');
      pauseBtn.setAttribute('data-active', '1');
    }

    function closeVideoPlayer() {
      const player = document.querySelector('.director-portfolio-lightbox');
      const video = player.querySelector('.director-portfolio-lightbox-media-video');
      
      video.pause();
      video.currentTime = 0;
      player.setAttribute('data-active', '0');
    }

    function toggleFullscreen() {
      const video = document.querySelector('.director-portfolio-lightbox-media-video');
      if (!document.fullscreenElement) {
        video.requestFullscreen().catch(err => {
          console.log(`Error attempting to enable fullscreen: ${err.message}`);
        });
      } else {
        document.exitFullscreen();
      }
    }

    function toggleVideo() {
      const video = document.querySelector('.director-portfolio-lightbox-media-video');
      if (video.paused) {
        playVideo();
      } else {
        pauseVideo();
      }
    }

    function playVideo() {
      const video = document.querySelector('.director-portfolio-lightbox-media-video');
      const playBtn = document.querySelector('.director-portfolio-lightbox-controls-play');
      const pauseBtn = document.querySelector('.director-portfolio-lightbox-controls-pause');
      
      video.play();
      playBtn.setAttribute('data-active', '0');
      pauseBtn.setAttribute('data-active', '1');
    }

    function pauseVideo() {
      const video = document.querySelector('.director-portfolio-lightbox-media-video');
      const playBtn = document.querySelector('.director-portfolio-lightbox-controls-play');
      const pauseBtn = document.querySelector('.director-portfolio-lightbox-controls-pause');
      
      video.pause();
      playBtn.setAttribute('data-active', '1');
      pauseBtn.setAttribute('data-active', '0');
    }

    function setProgress(event) {
      const video = document.querySelector('.director-portfolio-lightbox-media-video');
      const rect = event.currentTarget.getBoundingClientRect();
      const clickX = event.clientX - rect.left;
      const width = rect.width;
      const percentage = clickX / width;
      
      video.currentTime = percentage * video.duration;
    }

    function updateTimeDisplay() {
      const video = document.querySelector('.director-portfolio-lightbox-media-video');
      const currentTimeEl = document.querySelector('.director-portfolio-lightbox-controls-time-current');
      const totalTimeEl = document.querySelector('.director-portfolio-lightbox-controls-time-total');
      const progressBar = document.querySelector('.director-portfolio-lightbox-media-playbar-meter-progress');
      
      function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      }
      
      if (video.duration) {
        totalTimeEl.textContent = formatTime(video.duration);
      }
      
      function updateTime() {
        currentTimeEl.textContent = formatTime(video.currentTime);
        
        if (video.duration) {
          const percentage = (video.currentTime / video.duration) * 100;
          progressBar.style.width = percentage + '%';
        }
      }
      
      video.addEventListener('timeupdate', updateTime);
      updateTime();
    }

    // Update button states when video state changes
    function updateButtonStates() {
      const video = document.querySelector('.director-portfolio-lightbox-media-video');
      const playBtn = document.querySelector('.director-portfolio-lightbox-controls-play');
      const pauseBtn = document.querySelector('.director-portfolio-lightbox-controls-pause');
      
      if (video.paused) {
        playBtn.setAttribute('data-active', '1');
        pauseBtn.setAttribute('data-active', '0');
      } else {
        playBtn.setAttribute('data-active', '0');
        pauseBtn.setAttribute('data-active', '1');
      }
    }

    // Add event listeners for video state changes
    document.addEventListener('DOMContentLoaded', function() {
      const video = document.querySelector('.director-portfolio-lightbox-media-video');
      video.addEventListener('play', updateButtonStates);
      video.addEventListener('pause', updateButtonStates);
      video.addEventListener('ended', function() {
        updateButtonStates();
        // Auto close video player when video ends
        closeVideoPlayer();
      });

      // Prevent dragging for all images and videos
      document.addEventListener('dragstart', function(e) {
        if (e.target.tagName === 'IMG' || e.target.tagName === 'VIDEO') {
          e.preventDefault();
          return false;
        }
      });

      // Prevent text selection
      document.addEventListener('selectstart', function(e) {
        e.preventDefault();
        return false;
      });

      // Director toggle functionality
      initializeDirectorToggle();

      // Handle window resize for logo updates
      window.addEventListener('resize', function() {
        updateLogo();
      });
    });

    // Director toggle state
    let isMultiDirectorMode = false;

    function initializeDirectorToggle() {
      const triggerArea = document.getElementById('toggle-trigger-area');
      const toggle = document.getElementById('director-toggle');
      const toggleText = document.getElementById('toggle-text');

      // Show toggle when hovering over trigger area
      triggerArea.addEventListener('mouseenter', function() {
        toggle.classList.add('visible');
      });

      // Hide toggle when leaving trigger area (unless hovering over toggle itself)
      triggerArea.addEventListener('mouseleave', function(e) {
        // Check if mouse is moving to the toggle element
        if (!toggle.contains(e.relatedTarget)) {
          toggle.classList.remove('visible');
        }
      });

      // Keep toggle visible when hovering over it
      toggle.addEventListener('mouseenter', function() {
        toggle.classList.add('visible');
      });

      // Hide toggle when leaving it
      toggle.addEventListener('mouseleave', function() {
        toggle.classList.remove('visible');
      });

      // Toggle functionality
      toggle.addEventListener('click', function() {
        isMultiDirectorMode = !isMultiDirectorMode;
        updateDirectorMode();
      });
    }

    function updateDirectorMode() {
      const maxDirector = document.getElementById('max-director');
      const toggleText = document.getElementById('toggle-text');
      const toggle = document.getElementById('director-toggle');

      if (isMultiDirectorMode) {
        // Show Max Chan director
        maxDirector.style.display = 'block';
        toggleText.textContent = 'Multi Director';
        toggle.classList.add('active');
      } else {
        // Hide Max Chan director and close its submenu if open
        maxDirector.style.display = 'none';
        const maxProjects = document.getElementById('max-projects');
        maxProjects.classList.remove('open');
        toggleText.textContent = 'Single Director';
        toggle.classList.remove('active');
      }
    }
  </script>
</body>
</html>